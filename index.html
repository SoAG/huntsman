<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Huntsman by missinglink</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Huntsman</h1>
        <p class="header">A simple web spider</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/missinglink/huntsman/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/missinglink/huntsman/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/missinglink/huntsman">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/missinglink">missinglink</a></p>


      </header>
      <section>
        <h1>
<a name="a-super-simple-web-spider" class="anchor" href="#a-super-simple-web-spider"><span class="octicon octicon-link"></span></a>A super simple web spider</h1>

<p>Huntsman takes one or more 'seed' urls with the <code>spider.queue.add()</code> method.</p>

<p>Once the process is kicked off with <code>spider.start()</code>, it will take care of extracting links from the page and following only the pages we want.</p>

<p>To define which pages are crawled and extract data, use <code>spider.on()</code> with a string or regular expression.</p>

<p>Each page will only be crawled once. If multiple regular expressions match the uri, they will all be called.</p>

<p><strong>Page URLs which do not match an <code>on</code> condition will never be crawled</strong></p>

<h3>
<a name="install" class="anchor" href="#install"><span class="octicon octicon-link"></span></a>Install</h3>

<div class="highlight"><pre>npm install huntsman --save
</pre></div>

<p><a href="https://nodei.co/npm/huntsman/"><img src="https://nodei.co/npm/huntsman.png?downloads=true&amp;stars=true" alt="NPM"></a></p>

<h3>
<a name="example-script" class="anchor" href="#example-script"><span class="octicon octicon-link"></span></a>Example Script</h3>

<div class="highlight"><pre><span class="cm">/** Crawl wikipedia and use jquery syntax to extract information from the page **/</span>

<span class="kd">var</span> <span class="nx">huntsman</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'huntsman'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">spider</span> <span class="o">=</span> <span class="nx">huntsman</span><span class="p">.</span><span class="nx">spider</span><span class="p">();</span>

<span class="nx">spider</span><span class="p">.</span><span class="nx">extensions</span> <span class="o">=</span> <span class="p">[</span>
  <span class="nx">huntsman</span><span class="p">.</span><span class="nx">extension</span><span class="p">(</span> <span class="s1">'recurse'</span> <span class="p">),</span> <span class="c1">// load recurse extension &amp; follow anchor links</span>
  <span class="nx">huntsman</span><span class="p">.</span><span class="nx">extension</span><span class="p">(</span> <span class="s1">'cheerio'</span> <span class="p">)</span> <span class="c1">// load cheerio extension</span>
<span class="p">];</span>

<span class="c1">// follow pages which match this uri regex</span>
<span class="nx">spider</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span> <span class="sr">/http:\/\/en\.wikipedia\.org\/wiki\/\w+:\w+$/</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span> <span class="nx">err</span><span class="p">,</span> <span class="nx">res</span> <span class="p">){</span>

  <span class="c1">// use jquery-style selectors &amp; functions</span>
  <span class="kd">var</span> <span class="nx">$</span> <span class="o">=</span> <span class="nx">res</span><span class="p">.</span><span class="nx">extension</span><span class="p">.</span><span class="nx">cheerio</span><span class="p">;</span>

  <span class="c1">// extract information from page body</span>
  <span class="kd">var</span> <span class="nx">wikipedia</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">uri</span><span class="o">:</span> <span class="nx">res</span><span class="p">.</span><span class="nx">uri</span><span class="p">,</span>
    <span class="nx">heading</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'h1.firstHeading'</span><span class="p">).</span><span class="nx">text</span><span class="p">().</span><span class="nx">trim</span><span class="p">(),</span>
    <span class="nx">body</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">'div#mw-content-text p'</span><span class="p">).</span><span class="nx">text</span><span class="p">().</span><span class="nx">trim</span><span class="p">()</span>
  <span class="p">};</span>

  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">wikipedia</span> <span class="p">);</span>

<span class="p">});</span>

<span class="nx">spider</span><span class="p">.</span><span class="nx">queue</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span> <span class="s1">'http://en.wikipedia.org/wiki/Huntsman_spider'</span> <span class="p">);</span>
<span class="nx">spider</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span>
</pre></div>

<h3>
<a name="example-output" class="anchor" href="#example-output"><span class="octicon octicon-link"></span></a>Example Output</h3>

<div class="highlight"><pre>peter@edgy:/tmp<span class="nv">$ </span>node examples/html.js 
<span class="o">{</span>
  <span class="s2">"uri"</span>: <span class="s2">"http://en.wikipedia.org/wiki/Wikipedia:Recent_additions"</span>,
  <span class="s2">"heading"</span>: <span class="s2">"Wikipedia:Recent additions"</span>,
  <span class="s2">"body"</span>: <span class="s2">"This is a selection of recently created new articles and greatly expanded former stub articles on Wikipedia that were featured on the Main Page as part of Did you know? You can submit new pages for consideration. (Archives are grouped by month of Main page appearance.)Tip: To find which archive contains the fact that appeared on Did You Know?, return to the article and click \"What links here\" to the left of the article. Then, in the dropdown menu provided for namespace, choose Wikipedia and click \"Go\". When you find \"Wikipedia:Recent additions\" and a number, click it and search for the article name.\n\nCurrent archive"</span>
<span class="o">}</span>

... etc
</pre></div>

<p>More examples are available in the <a href="https://github.com/missinglink/huntsman/tree/master/examples" title="Title">/examples</a> directory</p>

<h2>
<a name="build-status" class="anchor" href="#build-status"><span class="octicon octicon-link"></span></a>Build Status</h2>

<p><a href="https://travis-ci.org/missinglink/huntsman"><img src="https://travis-ci.org/missinglink/huntsman.png?branch=master" alt="Build Status"></a></p>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		          <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-42558273-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>